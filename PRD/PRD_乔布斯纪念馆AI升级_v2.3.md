# äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)
# ä¹”å¸ƒæ–¯çºªå¿µé¦† AI äº¤äº’å‡çº§ v2.3

| é¡¹ç›®ä¿¡æ¯ | |
|---------|--|
| **é¡¹ç›®åç§°** | ä¹”å¸ƒæ–¯çºªå¿µé¦† (Jobs Memorial) AI äº¤äº’å‡çº§ |
| **é¡¹ç›®è´Ÿè´£äºº** | äº§å“ç»ç† |
| **ç‰ˆæœ¬** | v2.3 (å…¨é‡ä¼˜åŒ–ç‰ˆ) |
| **æ—¥æœŸ** | 2026å¹´2æœˆ5æ—¥ |
| **çŠ¶æ€** | ğŸš§ å¼€å‘ä¸­ (ä» v1.1.0 å‡çº§) |

---

## 1. é¡¹ç›®èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 èƒŒæ™¯
å½“å‰ç½‘ç«™ï¼ˆjobs-memorial.vercel.appï¼‰å·²å®Œæˆ v1.1.0 ç‰ˆæœ¬ï¼Œå®ç°äº† AI å¯¹è¯æ ¸å¿ƒåŠŸèƒ½ã€æµè§ˆé‡ç»Ÿè®¡ã€å†…å®¹å®‰å…¨è¿‡æ»¤å’Œé™æµç­–ç•¥ã€‚ä¸ºæå‡ç”¨æˆ·ä½“éªŒå’Œæ•°æ®é©±åŠ¨èƒ½åŠ›ï¼Œè®¡åˆ’è¿›è¡Œå…¨é‡ä¼˜åŒ–å‡çº§ã€‚

### 1.2 ç›®æ ‡

| ç›®æ ‡ç»´åº¦ | å…·ä½“æŒ‡æ ‡ |
|---------|---------|
| **åˆ†äº«ä½“éªŒå‡çº§** | é‡‘å¥æµ·æŠ¥ç”Ÿæˆï¼Œæå‡ç¤¾äº¤ä¼ æ’­ç‡ 30% |
| **äº¤äº’è´¨æ„Ÿæå‡** | Toast æç¤ºç»„ä»¶ï¼Œæ›¿ä»£åŸç”Ÿ alert |
| **ç§»åŠ¨ç«¯å®Œå–„** | å…¨å±å¯¹è¯æ¨¡å¼ï¼Œç§»åŠ¨ç«¯å¯ç”¨æ€§ 100% |
| **æ•°æ®é©±åŠ¨** | å®Œæ•´åŸ‹ç‚¹ç³»ç»Ÿï¼Œä¼˜åŒ–äº§å“å†³ç­– |
| **ç³»ç»Ÿç¨³å®šæ€§** | å¤š AI æ¨¡å‹å¤‡é€‰ï¼Œæå‡å¯ç”¨æ€§è‡³ 99.9% |

---

## 2. æ–°å¢åŠŸèƒ½æè¿° (v2.3)

### 2.1 é‡‘å¥æµ·æŠ¥ç”ŸæˆåŠŸèƒ½ â­ P0

#### åŠŸèƒ½æ¦‚è¿°
å°† AI å›å¤ä¸­çš„é‡‘å¥ç”Ÿæˆä¸ºä¹”å¸ƒæ–¯é£æ ¼çš„å¯åˆ†äº«æµ·æŠ¥å›¾ç‰‡ã€‚

#### UI è®¾è®¡

**æ¡Œé¢ç«¯**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI æ¶ˆæ¯æ°”æ³¡                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ã€‚ä½ åœ¨ä¸€å †å¹³åº¸åŠŸèƒ½ä¸Šæµªè´¹... â”‚   â”‚
â”‚  â”‚                                [ğŸ“¤åˆ†äº«] â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“ ç‚¹å‡»åˆ†äº«
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              [æµ·æŠ¥é¢„è§ˆ]                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚   "è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ã€‚ä½ åœ¨ä¸€å †        â”‚    â”‚   â”‚
â”‚  â”‚  â”‚    å¹³åº¸åŠŸèƒ½ä¸Šæµªè´¹ç²¾åŠ›ã€‚           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚    ç æ‰70%ï¼Œåšåˆ° Insanely Great." â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚            â€” Steve Jobs          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                 â”‚    â”‚   â”‚
â”‚  â”‚  â”‚    [ä¹”å¸ƒæ–¯å‰ªå½± / Apple Logo]     â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                 â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                          â”‚   â”‚
â”‚  â”‚  [ä¸‹è½½å›¾ç‰‡]  [å¤åˆ¶åˆ°å‰ªè´´æ¿]  [å–æ¶ˆ]      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æµ·æŠ¥æ ·å¼è§„èŒƒ**
| å…ƒç´  | è§„èŒƒ |
|------|------|
| **å°ºå¯¸** | 1080Ã—1080 (1:1) æˆ– 1080Ã—1920 (9:16) |
| **èƒŒæ™¯** | çº¯é»‘ `#000000` æˆ–æ·±ç°æ¸å˜ |
| **å­—ä½“** | SF Pro Display / Inter |
| **æ–‡å­—é¢œè‰²** | ç™½è‰² `#FFFFFF` |
| **æ°´å°** | åŠé€æ˜ä¹”å¸ƒæ–¯å‰ªå½±æˆ– Apple logo (10% é€æ˜åº¦) |
| **è¾¹æ¡†** | 1px ç™½è‰²ç»†çº¿è¾¹æ¡† |
| **ç½²å** | å³ä¸‹è§’ "â€” Steve Jobs" |
| **å“ç‰Œæ ‡è¯†** | åº•éƒ¨å°å­— "jobs-memorial.vercel.app" |

#### æŠ€æœ¯å®ç°

**æ–¹æ¡ˆé€‰æ‹©ï¼šhtml2canvas**
```typescript
// lib/quote-poster.ts
export interface PosterOptions {
  text: string;
  author?: string;
  size?: 'square' | 'portrait';
  theme?: 'dark' | 'light';
}

export async function generateQuotePoster(
  options: PosterOptions
): Promise<Blob> {
  // 1. åˆ›å»ºéšè—çš„ DOM å…ƒç´ 
  const container = createPosterElement(options);

  // 2. ä½¿ç”¨ html2canvas æ¸²æŸ“
  const canvas = await html2canvas(container, {
    scale: 2, // 2x åˆ†è¾¨ç‡
    backgroundColor: '#000000',
    logging: false,
  });

  // 3. è½¬æ¢ä¸º Blob
  return new Promise((resolve) => {
    canvas.toBlob((blob) => {
      resolve(blob!);
    }, 'image/png');
  });
}
```

**ä¾èµ–å®‰è£…**
```bash
npm install html2canvas
npm install --save-dev @types/html2canvas
```

#### é‡‘å¥æå–ç®—æ³•ä¼˜åŒ–

```typescript
// å¢å¼ºç‰ˆé‡‘å¥æå–
export function extractQuote(message: string): QuoteResult | null {
  if (!message || message.length < 20) return null;

  // ç­–ç•¥1: åŒ…å«å…³é”®è¯çš„å¥å­
  const powerWords = [
    'Simplicity', 'Focus', 'Great', 'Art', 'Taste',
    'ç®€å•', 'æè‡´', 'ä¸“æ³¨', 'ä¸', 'è‰ºæœ¯', 'å“å‘³'
  ];

  // ç­–ç•¥2: è‹±æ–‡å¼•è¯­
  const englishQuotes = message.match(/"[A-Z][^"]{20,}"/g);

  // ç­–ç•¥3: æœ€é•¿ä¸”æœ€æœ‰åŠ›é‡çš„å¥å­
  const sentences = message.split(/[ã€‚ï¼ï¼Ÿ.!?]/)
    .filter(s => s.trim().length > 15);

  // è¯„åˆ†ç³»ç»Ÿ
  let bestSentence = '';
  let maxScore = 0;

  for (const sentence of sentences) {
    let score = sentence.length * 0.3; // é•¿åº¦æƒé‡

    // å…³é”®è¯åŠ åˆ†
    for (const word of powerWords) {
      if (sentence.includes(word)) score += 20;
    }

    // è‹±æ–‡åŠ åˆ†
    if (/[a-zA-Z]{10,}/.test(sentence)) score += 15;

    // ç®€çŸ­æœ‰åŠ›åŠ åˆ†
    if (sentence.length < 50) score += 10;

    if (score > maxScore) {
      maxScore = score;
      bestSentence = sentence;
    }
  }

  return {
    text: bestSentence.trim() || message.slice(0, 100),
    startIndex: message.indexOf(bestSentence),
    endIndex: message.indexOf(bestSentence) + bestSentence.length,
  };
}
```

#### äº¤äº’æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant C as ChatPanel
    participant P as PosterGenerator
    participant D as ä¸‹è½½

    U->>C: ç‚¹å‡»åˆ†äº«æŒ‰é’®
    C->>C: æå–é‡‘å¥
    C->>P: ç”Ÿæˆæµ·æŠ¥
    P->>P: æ¸²æŸ“ DOM â†’ Canvas â†’ Blob
    P-->>C: è¿”å›å›¾ç‰‡ Blob
    C->>C: æ˜¾ç¤ºé¢„è§ˆå¼¹çª—
    U->>C: ç‚¹å‡»ä¸‹è½½
    C->>D: è§¦å‘æµè§ˆå™¨ä¸‹è½½
    U->>C: ç‚¹å‡»å¤åˆ¶
    C->>C: å¤åˆ¶åˆ°å‰ªè´´æ¿
    C->>U: æ˜¾ç¤º Toast æç¤º
```

---

### 2.2 Toast æç¤ºç»„ä»¶ â­ P0

#### åŠŸèƒ½æ¦‚è¿°
æ›¿ä»£åŸç”Ÿ `alert()`ï¼Œæä¾›ä¼˜é›…çš„æç¤ºåé¦ˆç»„ä»¶ã€‚

#### è®¾è®¡è§„èŒƒ

**Toast ç±»å‹**
| ç±»å‹ | å›¾æ ‡ | é¢œè‰² | ä½¿ç”¨åœºæ™¯ |
|------|------|------|----------|
| success | âœ… | ç»¿è‰²æ¸å˜ | åˆ†äº«æˆåŠŸã€å¤åˆ¶æˆåŠŸ |
| error | âŒ | çº¢è‰²æ¸å˜ | æ“ä½œå¤±è´¥ã€é”™è¯¯æç¤º |
| info | â„¹ï¸ | è“è‰²æ¸å˜ | ä¸€èˆ¬ä¿¡æ¯æç¤º |
| warning | âš ï¸ | é»„è‰²æ¸å˜ | è­¦å‘Šæç¤º |

**UI è®¾è®¡**
```typescript
// components/Toast.tsx
interface ToastProps {
  type: 'success' | 'error' | 'info' | 'warning';
  message: string;
  duration?: number; // é»˜è®¤ 3000ms
  onClose?: () => void;
}
```

**æ ·å¼è§„èŒƒ**
| å…ƒç´  | è§„èŒƒ |
|------|------|
| **ä½ç½®** | å±å¹•é¡¶éƒ¨ä¸­å¤® (top: 20px) |
| **å®½åº¦** | æœ€å¤§ 400pxï¼Œè‡ªé€‚åº”å†…å®¹ |
| **åœ†è§’** | 12px |
| **é˜´å½±** | `0 8px 32px rgba(0,0,0,0.2)` |
| **åŠ¨ç”»** | æ»‘å…¥/æ·¡å‡º 300ms ease-out |
| **å›¾æ ‡** | 20px Ã— 20px |
| **å­—ä½“** | 14px, ä¸­ç­‰å­—é‡ |

#### ä½¿ç”¨ç¤ºä¾‹

```typescript
// lib/toast.ts
export const toast = {
  success: (message: string) => showToast({ type: 'success', message }),
  error: (message: string) => showToast({ type: 'error', message }),
  info: (message: string) => showToast({ type: 'info', message }),
  warning: (message: string) => showToast({ type: 'warning', message }),
};

// ä½¿ç”¨ç¤ºä¾‹
toast.success('é‡‘å¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
toast.error('ç”Ÿæˆæµ·æŠ¥å¤±è´¥ï¼Œè¯·é‡è¯•');
```

#### æŠ€æœ¯å®ç°

```typescript
// components/ToastProvider.tsx
'use client';

import { createContext, useContext, useState, useCallback } from 'react';
import { AnimatePresence } from 'framer-motion';
import Toast from './Toast';

interface ToastItem {
  id: string;
  type: 'success' | 'error' | 'info' | 'warning';
  message: string;
}

const ToastContext = createContext<{
  toast: (type: ToastItem['type'], message: string) => void;
}>({
  toast: () => {},
});

export function ToastProvider({ children }: { children: React.ReactNode }) {
  const [toasts, setToasts] = useState<ToastItem[]>([]);

  const toast = useCallback((type: ToastItem['type'], message: string) => {
    const id = Math.random().toString(36).slice(2);
    setToasts(prev => [...prev, { id, type, message }]);

    // è‡ªåŠ¨ç§»é™¤
    setTimeout(() => {
      setToasts(prev => prev.filter(t => t.id !== id));
    }, 3000);
  }, []);

  return (
    <ToastContext.Provider value={{ toast }}>
      {children}

      {/* Toast å®¹å™¨ */}
      <div className="fixed top-4 left-1/2 -translate-x-1/2 z-[100] space-y-2">
        <AnimatePresence>
          {toasts.map(toast => (
            <Toast key={toast.id} {...toast} />
          ))}
        </AnimatePresence>
      </div>
    </ToastContext.Provider>
  );
}

export const useToast = () => useContext(ToastContext);
```

---

### 2.3 ç§»åŠ¨ç«¯å…¨å±å¯¹è¯ â­ P0

#### åŠŸèƒ½æ¦‚è¿°
åœ¨å°å±è®¾å¤‡ï¼ˆå®½åº¦ < 768pxï¼‰ä¸Šï¼Œå¯¹è¯é¢æ¿è‡ªåŠ¨åˆ‡æ¢ä¸ºå…¨å±æ¨¡å¼ã€‚

#### è®¾è®¡è§„èŒƒ

**ç§»åŠ¨ç«¯å…¨å±å¸ƒå±€**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”â”â”â”â” âœ•     Ask Steve         â”‚ â† å›ºå®šå¤´éƒ¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  [æ¶ˆæ¯æ°”æ³¡åŒºåŸŸ - å¯æ»šåŠ¨]         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ AI: è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨...      â”‚  â”‚
â”‚  â”‚                    [ğŸ“¤åˆ†äº«] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  [é¢„è®¾é—®é¢˜æ ‡ç­¾ - æ¨ªå‘æ»šåŠ¨]       â”‚
â”‚  â† äº§å“å–èˆ å®¡ç¾çº å â†’           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ è¾“å…¥é—®é¢˜...         [å‘é€]â”‚   â”‚ â† å›ºå®šåº•éƒ¨
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  å…¨å±é«˜åº¦ (100vh)
```

#### å“åº”å¼æ–­ç‚¹

| æ–­ç‚¹ | å®½åº¦ | å¯¹è¯æ¡†è¡Œä¸º |
|------|------|-----------|
| **ç§»åŠ¨ç«¯** | < 768px | å…¨å±å±…ä¸­å¼¹çª— |
| **å¹³æ¿** | 768px - 1024px | å³ä¾§å›ºå®šé¢æ¿ï¼Œå®½åº¦ 400px |
| **æ¡Œé¢ç«¯** | > 1024px | å³ä¾§å›ºå®šé¢æ¿ï¼Œå®½åº¦ 420px |

#### æŠ€æœ¯å®ç°

```typescript
// components/ChatPanel.tsx (å¢å¼ºç‰ˆ)
export default function ChatPanel({ /* ... */ }) {
  const [isMobile] = useMediaQuery('(max-width: 768px)');

  return (
    <motion.div
      className={cn(
        "bg-black/95 backdrop-blur-xl border border-white/20 shadow-2xl",
        "overflow-hidden flex flex-col z-50",
        isMobile ? "fixed inset-0 rounded-none" : "fixed top-1/2 right-24 -translate-y-1/2 rounded-3xl max-w-[400px] max-h-[80vh]"
      )}
    >
      {/* ç§»åŠ¨ç«¯ï¼šå…¨å±å¤´éƒ¨ */}
      <div className={cn(
        "flex items-center justify-between border-b border-white/10",
        isMobile ? "px-4 py-4" : "px-4 py-3"
      )}>
        <div className="flex items-center gap-2">
          {/* ... */}
        </div>
      </div>

      {/* æ¶ˆæ¯åŒºåŸŸ - ç§»åŠ¨ç«¯å æ®å‰©ä½™ç©ºé—´ */}
      <div className={cn(
        "overflow-y-auto",
        isMobile ? "flex-1" : "max-h-[300px]"
      )}>
        {/* ... */}
      </div>

      {/* è¾“å…¥åŒºåŸŸ - ç§»åŠ¨ç«¯å›ºå®šåº•éƒ¨ */}
      <div className={cn(
        "border-t border-white/10",
        isMobile ? "p-4 safe-area-bottom" : "p-3"
      )}>
        {/* ... */}
      </div>
    </motion.div>
  );
}
```

**iOS å®‰å…¨åŒºåŸŸé€‚é…**
```css
/* æ”¯æŒåˆ˜æµ·å±å’Œåº•éƒ¨æŒ‡ç¤ºå™¨ */
@supports (padding: max(0px)) {
  .safe-area-bottom {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }
}
```

---

### 2.4 åŸ‹ç‚¹æ•°æ®åˆ†æç³»ç»Ÿ â­ P1

#### åŠŸèƒ½æ¦‚è¿°
å»ºç«‹å®Œæ•´çš„æ•°æ®æ”¶é›†å’Œåˆ†æç³»ç»Ÿï¼Œæ”¯æŒäº§å“ä¼˜åŒ–å†³ç­–ã€‚

#### åŸ‹ç‚¹äº‹ä»¶å®šä¹‰

```typescript
// lib/analytics.ts
export interface AnalyticsEvent {
  event: string;
  properties: Record<string, any>;
  timestamp: number;
  userId?: string;
  sessionId: string;
}

// äº‹ä»¶åˆ—è¡¨
export const ANALYTICS_EVENTS = {
  // å¯¹è¯ç›¸å…³
  'chat.opened': {
    source: 'button' | 'tag' | 'direct',
    page: string,
  },
  'chat.message_sent': {
    preset_id?: string,
    message_length: number,
    has_brand_keyword: boolean,
  },
  'chat.completed': {
    rounds: number,
    duration_ms: number,
    messages_count: number,
  },

  // å†…å®¹ç›¸å…³
  'tag.clicked': {
    tag_id: string,
    tag_label: string,
  },
  'keyword.triggered': {
    keyword: string,
    category: 'brand' | 'general',
  },
  'quote.shared': {
    method: 'copy' | 'download',
    quote_length: number,
  },

  // é”™è¯¯ç›¸å…³
  'rate_limit.hit': {
    limit_type: 'ip' | 'session',
    remaining: number,
  },
  'content.blocked': {
    reason: string,
    category: 'sensitive' | 'ad',
  },
  'ai.error': {
    provider: 'zhipu' | 'deepseek' | 'openai',
    error_type: string,
  },
};
```

#### æ•°æ®æ”¶é›†æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯åŸ‹ç‚¹å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ é¡µé¢è®¿é—®    â”‚  â”‚ äº¤äº’ç‚¹å‡»    â”‚  â”‚ é”™è¯¯æ•è·            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        API ç½‘å…³å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  /api/analytics/event - æ¥æ”¶åŸ‹ç‚¹æ•°æ®                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å­˜å‚¨å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Vercel KV (å®æ—¶æ•°æ®)     â”‚  â”‚  JSON æ–‡ä»¶ (å†å²æ•°æ®)    â”‚ â”‚
â”‚  â”‚  - ä»Šæ—¥ç»Ÿè®¡               â”‚  â”‚  - è¯¦ç»†äº‹ä»¶æ—¥å¿—          â”‚ â”‚
â”‚  â”‚  - çƒ­é—¨æ ‡ç­¾               â”‚  â”‚  - å¯å¯¼å‡ºåˆ†æ            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### API ç«¯ç‚¹è®¾è®¡

**POST /api/analytics/event**
```typescript
// è®°å½•å•ä¸ªäº‹ä»¶
interface EventRequest {
  event: string;
  properties: Record<string, any>;
}

// å“åº”
interface EventResponse {
  success: boolean;
  eventId: string;
}
```

**GET /api/analytics/stats**
```typescript
// è·å–ç»Ÿè®¡æ•°æ®
interface StatsResponse {
  total_chats: number;
  total_messages: number;
  avg_rounds: number;
  popular_tags: Array<{ tag_id: string; count: number }>;
  top_quotes: Array<{ quote: string; shares: number }>;
  brand_triggers: number;
  error_rate: number;
}
```

#### æ•°æ®éšç§

| æ•°æ®ç±»å‹ | å¤„ç†æ–¹å¼ | ä¿ç•™æœŸé™ |
|---------|---------|----------|
| **IP åœ°å€** | åŒ¿ååŒ–ï¼ˆå8ä½æ©ç ï¼‰ | 7å¤©ååˆ é™¤ |
| **å¯¹è¯å†…å®¹** | ä»…è®°å½•é•¿åº¦ï¼Œä¸å­˜å‚¨åŸæ–‡ | ä¸å­˜å‚¨ |
| **åŸ‹ç‚¹äº‹ä»¶** | åŒ¿ååŒ–ï¼Œæ— ç”¨æˆ·æ ‡è¯† | 90å¤©ååˆ é™¤ |
| **Session ID** | éšæœºç”Ÿæˆï¼Œæ— å…³è”ä¿¡æ¯ | 24å°æ—¶åè¿‡æœŸ |

---

### 2.5 é€šç”¨ AI æ”¯æŒ â­ P1

#### åŠŸèƒ½æ¦‚è¿°
æ”¯æŒå¤šä¸ª AI æä¾›å•†ï¼Œå®ç°æ™ºèƒ½é™çº§å’Œè´Ÿè½½å‡è¡¡ã€‚

#### æä¾›å•†é…ç½®

```typescript
// lib/ai-config.ts
export interface AIProvider {
  id: string;
  name: string;
  model: string;
  enabled: boolean;
  priority: number; // 1æœ€é«˜
  costPer1kTokens: number;
}

export const AI_PROVIDERS: AIProvider[] = [
  {
    id: 'zhipu',
    name: 'æ™ºè°± AI (GLM-4.7)',
    model: 'glm-4-flash',
    enabled: !!process.env.ZHIPU_API_KEY,
    priority: 1,
    costPer1kTokens: 0.1,
  },
  {
    id: 'deepseek',
    name: 'DeepSeek-V3',
    model: 'deepseek-chat',
    enabled: !!process.env.DEEPSEEK_API_KEY,
    priority: 2,
    costPer1kTokens: 0.001,
  },
  {
    id: 'openai',
    name: 'OpenAI GPT-4o',
    model: 'gpt-4o',
    enabled: !!process.env.OPENAI_API_KEY,
    priority: 3,
    costPer1kTokens: 2.5,
  },
];
```

#### æ™ºèƒ½è·¯ç”±ç­–ç•¥

```typescript
// lib/ai-router.ts
export class AIRouter {
  private providers: Map<string, AIClient>;
  private failureCount: Map<string, number>;

  /**
   * é€‰æ‹©æœ€ä½³ AI æä¾›å•†
   */
  async selectProvider(): Promise<string> {
    const enabled = AI_PROVIDERS.filter(p => p.enabled);

    // ä¼˜å…ˆçº§æ’åºï¼šå¤±è´¥æ¬¡æ•°å°‘çš„ä¼˜å…ˆ
    const sorted = enabled.sort((a, b) => {
      const aFailures = this.failureCount.get(a.id) || 0;
      const bFailures = this.failureCount.get(b.id) || 0;

      if (aFailures !== bFailures) {
        return aFailures - bFailures; // å¤±è´¥å°‘çš„ä¼˜å…ˆ
      }

      return a.priority - b.priority; // ä¼˜å…ˆçº§é«˜çš„ä¼˜å…ˆ
    });

    return sorted[0].id;
  }

  /**
   * è°ƒç”¨ AIï¼ˆè‡ªåŠ¨é‡è¯•ï¼‰
   */
  async chat(messages: ChatMessage[], maxRetries = 2): Promise<string> {
    for (let attempt = 0; attempt <= maxRetries; attempt++) {
      const providerId = await this.selectProvider();
      const provider = AI_PROVIDERS.find(p => p.id === providerId)!;

      try {
        const client = this.providers.get(providerId);
        const result = await client!.chat(messages);

        // æˆåŠŸåé‡ç½®å¤±è´¥è®¡æ•°
        this.failureCount.set(providerId, 0);

        return result;
      } catch (error) {
        const failures = (this.failureCount.get(providerId) || 0) + 1;
        this.failureCount.set(providerId, failures);

        console.error(`${provider.name} è°ƒç”¨å¤±è´¥ (${attempt + 1}/${maxRetries + 1})`, error);

        // æœ€åä¸€æ¬¡å°è¯•ä¹Ÿå¤±è´¥äº†
        if (attempt === maxRetries) {
          throw new Error('æ‰€æœ‰ AI æä¾›å•†å‡ä¸å¯ç”¨');
        }
      }
    }

    throw new Error('AI è°ƒç”¨å¤±è´¥');
  }
}
```

#### å¥åº·æ£€æŸ¥

```typescript
// lib/ai-health.ts
export async function checkAIHealth(): Promise<HealthStatus> {
  const results: Record<string, boolean> = {};

  for (const provider of AI_PROVIDERS) {
    if (!provider.enabled) {
      results[provider.id] = false;
      continue;
    }

    try {
      const client = getAIClient(provider.id);
      // å‘é€æµ‹è¯•è¯·æ±‚
      await client.chat([{ role: 'user', content: 'Hi' }]);
      results[provider.id] = true;
    } catch {
      results[provider.id] = false;
    }
  }

  const healthyCount = Object.values(results).filter(Boolean).length;

  return {
    all: AI_PROVIDERS,
    healthy: results,
    healthyCount,
    hasBackup: healthyCount > 1,
  };
}
```

---

### 2.6 å¯¹è¯å†å²æŒä¹…åŒ– â­ P1

#### åŠŸèƒ½æ¦‚è¿°
å¯é€‰åœ°å°†å¯¹è¯å†å²ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼Œæ”¯æŒè·¨ä¼šè¯æ¢å¤ã€‚

#### éšç§è®¾è®¡åŸåˆ™

| è®¾è®¡å†³ç­– | ç†ç”± |
|---------|------|
| **é»˜è®¤å…³é—­** | ä¿æŠ¤ç”¨æˆ·éšç§ |
| **å¯é€‰å¼€å¯** | ç”¨æˆ·ä¸»åŠ¨é€‰æ‹© |
| **æœ¬åœ°å­˜å‚¨** | æ•°æ®ä¸ä¸Šä¼ æœåŠ¡å™¨ |
| **è‡ªåŠ¨è¿‡æœŸ** | 30å¤©åè‡ªåŠ¨åˆ é™¤ |
| **ä¸€é”®æ¸…é™¤** | éšæ—¶å¯ä»¥åˆ é™¤ |

#### æŠ€æœ¯å®ç°

```typescript
// lib/chat-history.ts
const HISTORY_KEY = 'jobs_memorial_chat_history';
const MAX_HISTORY_DAYS = 30;

export interface ChatHistory {
  id: string;
  messages: Array<{
    role: 'user' | 'assistant';
    content: string;
    timestamp: number;
  }>;
  createdAt: number;
  updatedAt: number;
}

/**
 * ä¿å­˜å¯¹è¯å†å²
 */
export function saveChatHistory(
  sessionId: string,
  messages: ChatMessage[]
): void {
  const history: ChatHistory = {
    id: sessionId,
    messages: messages.map(m => ({
      ...m,
      timestamp: Date.now(),
    })),
    createdAt: Date.now(),
    updatedAt: Date.now(),
  };

  // è·å–ç°æœ‰å†å²
  const allHistory = getAllHistory();
  allHistory[sessionId] = history;

  // æ¸…ç†è¿‡æœŸæ•°æ®
  cleanupExpiredHistory(allHistory);

  // ä¿å­˜åˆ° localStorage
  localStorage.setItem(HISTORY_KEY, JSON.stringify(allHistory));
}

/**
 * è·å–å¯¹è¯å†å²
 */
export function getChatHistory(sessionId: string): ChatHistory | null {
  const allHistory = getAllHistory();
  return allHistory[sessionId] || null;
}

/**
 * è·å–æ‰€æœ‰å†å²
 */
export function getAllHistory(): Record<string, ChatHistory> {
  const data = localStorage.getItem(HISTORY_KEY);
  return data ? JSON.parse(data) : {};
}

/**
 * åˆ é™¤æŒ‡å®šå†å²
 */
export function deleteChatHistory(sessionId: string): void {
  const allHistory = getAllHistory();
  delete allHistory[sessionId];
  localStorage.setItem(HISTORY_KEY, JSON.stringify(allHistory));
}

/**
 * æ¸…ç©ºæ‰€æœ‰å†å²
 */
export function clearAllHistory(): void {
  localStorage.removeItem(HISTORY_KEY);
}

/**
 * æ¸…ç†è¿‡æœŸå†å²
 */
function cleanupExpiredHistory(
  history: Record<string, ChatHistory>
): void {
  const now = Date.now();
  const maxAge = MAX_HISTORY_DAYS * 24 * 60 * 60 * 1000;

  for (const [id, item] of Object.entries(history)) {
    if (now - item.updatedAt > maxAge) {
      delete history[id];
    }
  }
}

/**
 * è®¡ç®—å†å²å­˜å‚¨å¤§å°
 */
export function getHistorySize(): number {
  const data = localStorage.getItem(HISTORY_KEY);
  return data ? new Blob([data]).size : 0;
}
```

#### UI ç»„ä»¶

```typescript
// components/ChatHistory.tsx
export function ChatHistorySettings() {
  const [saved, setSaved] = useState(false);
  const [historyCount, setHistoryCount] = useState(0);
  const [size, setSize] = useState(0);

  useEffect(() => {
    // åŠ è½½è®¾ç½®
    const enabled = localStorage.getItem('chat_history_enabled') === 'true';
    setSaved(enabled);

    // åŠ è½½ç»Ÿè®¡
    const allHistory = getAllHistory();
    setHistoryCount(Object.keys(allHistory).length);
    setSize(getHistorySize());
  }, []);

  const toggleSave = (enabled: boolean) => {
    localStorage.setItem('chat_history_enabled', String(enabled));
    setSaved(enabled);

    if (!enabled) {
      clearAllHistory();
      setHistoryCount(0);
      setSize(0);
    }

    toast.success(
      enabled ? 'å¯¹è¯å†å²å·²å¼€å¯' : 'å¯¹è¯å†å²å·²æ¸…ç©º'
    );
  };

  return (
    <div className="px-4 py-3 border-t border-white/10">
      <div className="flex items-center justify-between mb-2">
        <span className="text-white/60 text-sm">
          ä¿å­˜å¯¹è¯å†å²
        </span>
        <button
          onClick={() => toggleSave(!saved)}
          className={cn(
            "w-12 h-6 rounded-full transition-colors relative",
            saved ? "bg-white/20" : "bg-white/5"
          )}
        >
          <div
            className={cn(
              "w-5 h-5 bg-white rounded-full absolute top-0.5 transition-all",
              saved ? "left-6" : "left-0.5"
            )}
          />
        </button>
      </div>

      {saved && (
        <div className="text-white/40 text-xs">
          {historyCount} æ¡å†å² Â· {(size / 1024).toFixed(1)} KB
          <button
            onClick={() => {
              clearAllHistory();
              setHistoryCount(0);
              setSize(0);
              toast.success('å†å²è®°å½•å·²æ¸…ç©º');
            }}
            className="ml-2 text-white/60 hover:text-white/80"
          >
            æ¸…ç©º
          </button>
        </div>
      )}
    </div>
  );
}
```

---

## 3. æŠ€æœ¯æ¶æ„æ›´æ–°

### 3.1 ä¾èµ–æ›´æ–°

```json
{
  "dependencies": {
    "html2canvas": "^1.4.1",
    "@ai-sdk/deepseek": "^0.0.4",
    "@ai-sdk/openai": "^0.0.7"
  },
  "devDependencies": {
    "@types/html2canvas": "^1.0.0"
  }
}
```

### 3.2 ç›®å½•ç»“æ„

```
jobs memorial/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ analytics/
â”‚   â”‚   â”‚   â”œâ”€â”€ event/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ route.ts          # åŸ‹ç‚¹äº‹ä»¶ä¸ŠæŠ¥
â”‚   â”‚   â”‚   â””â”€â”€ stats/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts          # ç»Ÿè®¡æ•°æ®æŸ¥è¯¢
â”‚   â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”‚   â””â”€â”€ route.ts              # èŠå¤© API (å¢å¼º)
â”‚   â”‚   â””â”€â”€ poster/
â”‚   â”‚       â””â”€â”€ route.ts              # æµ·æŠ¥ç”ŸæˆæœåŠ¡ç«¯
â”‚   â””â”€â”€ layout.tsx                    # æ·»åŠ  ToastProvider
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ChatPanel.tsx                 # å¢å¼ºç‰ˆå¯¹è¯é¢æ¿
â”‚   â”œâ”€â”€ Toast.tsx                     # Toast ç»„ä»¶
â”‚   â”œâ”€â”€ ToastProvider.tsx             # Toast ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ QuotePoster.tsx               # æµ·æŠ¥ç”Ÿæˆç»„ä»¶
â”‚   â””â”€â”€ ChatHistory.tsx               # å†å²è®°å½•ç»„ä»¶
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ ai.ts                         # AI é…ç½® (å¢å¼º)
â”‚   â”œâ”€â”€ ai-router.ts                  # AI è·¯ç”±å™¨
â”‚   â”œâ”€â”€ ai-health.ts                  # AI å¥åº·æ£€æŸ¥
â”‚   â”œâ”€â”€ quote-poster.ts               # æµ·æŠ¥ç”Ÿæˆ
â”‚   â”œâ”€â”€ chat-history.ts               # å¯¹è¯å†å²
â”‚   â”œâ”€â”€ analytics.ts                  # åŸ‹ç‚¹ç³»ç»Ÿ
â”‚   â”œâ”€â”€ toast.ts                      # Toast å·¥å…·
â”‚   â”œâ”€â”€ rate-limit.ts                 # é™æµ (å·²æœ‰)
â”‚   â””â”€â”€ visit-counter.ts              # è®¿é—®ç»Ÿè®¡ (å·²æœ‰)
â””â”€â”€ types/
    â”œâ”€â”€ analytics.ts                  # åŸ‹ç‚¹ç±»å‹
    â””â”€â”€ chat.ts                       # èŠå¤©ç±»å‹
```

---

## 4. å®æ–½è®¡åˆ’

### 4.1 å¼€å‘æ’æœŸ (72 å°æ—¶å·¥ä½œåŒ…)

| é˜¶æ®µ | æ—¶é—´ | ä»»åŠ¡ | äº§å‡º |
|------|------|------|------|
| **D1 ä¸Šåˆ** | 4h | Toast ç»„ä»¶å¼€å‘ | ToastProvider + Toast ç»„ä»¶ |
| **D1 ä¸‹åˆ** | 4h | é‡‘å¥æµ·æŠ¥ç”Ÿæˆ | html2canvas é›†æˆ + æµ·æŠ¥ç»„ä»¶ |
| **D2 ä¸Šåˆ** | 4h | ç§»åŠ¨ç«¯å…¨å±å¯¹è¯ | å“åº”å¼å¸ƒå±€ + å…¨å±æ¨¡å¼ |
| **D2 ä¸‹åˆ** | 4h | åŸ‹ç‚¹ç³»ç»Ÿ | äº‹ä»¶æ”¶é›† + API ç«¯ç‚¹ |
| **D3 ä¸Šåˆ** | 4h | é€šç”¨ AI æ”¯æŒ | å¤šæä¾›å•† + æ™ºèƒ½è·¯ç”± |
| **D3 ä¸‹åˆ** | 4h | å¯¹è¯å†å²æŒä¹…åŒ– | æœ¬åœ°å­˜å‚¨ + UI ç»„ä»¶ |

### 4.2 æµ‹è¯•è®¡åˆ’

#### åŠŸèƒ½æµ‹è¯•æ¸…å•
```
â–¡ Toast æç¤ºæ­£å¸¸æ˜¾ç¤ºå’Œè‡ªåŠ¨æ¶ˆå¤±
â–¡ é‡‘å¥æµ·æŠ¥ç”ŸæˆæˆåŠŸå¹¶å¯ä¸‹è½½
â–¡ ç§»åŠ¨ç«¯å¯¹è¯é¢æ¿å…¨å±æ˜¾ç¤º
â–¡ åŸ‹ç‚¹æ•°æ®æ­£ç¡®ä¸ŠæŠ¥
â–¡ AI æä¾›å•†è‡ªåŠ¨åˆ‡æ¢
â–¡ å¯¹è¯å†å²ä¿å­˜å’Œæ¢å¤
â–¡ æ‰€æœ‰ç»„ä»¶åœ¨ iOS/Android æ­£å¸¸å·¥ä½œ
```

---

## 5. æˆåŠŸæ ‡å‡†

### 5.1 ä¸Šçº¿æ ‡å‡† (MVP)

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| åŠŸèƒ½å®Œæ•´æ€§ | 100% (æ‰€æœ‰ P0+P1 åŠŸèƒ½å¯ç”¨) |
| ç§»åŠ¨ç«¯å¯ç”¨æ€§ | 100% (iOS/Android æ— ä¸¥é‡ bug) |
| æµ·æŠ¥ç”ŸæˆæˆåŠŸç‡ | â‰¥95% |
| AI å¯ç”¨æ€§ | â‰¥99.9% (å¤šæä¾›å•†å¤‡é€‰) |

### 5.2 è¿è¥ç›®æ ‡ (ä¸Šçº¿å30å¤©)

| æŒ‡æ ‡ | ç›®æ ‡å€¼ |
|------|--------|
| é‡‘å¥åˆ†äº«ç‡ | â‰¥10% (å½“å‰ 5%) |
| ç§»åŠ¨ç«¯å¯¹è¯ç‡ | â‰¥20% |
| åŸ‹ç‚¹æ•°æ®å®Œæ•´æ€§ | â‰¥90% |
| å¯¹è¯å†å²ä½¿ç”¨ç‡ | â‰¥15% |

---

## 6. é£é™©ä¸åº”å¯¹

| é£é™© | ç­‰çº§ | åº”å¯¹æªæ–½ |
|------|------|---------|
| **html2canvas å…¼å®¹æ€§é—®é¢˜** | ä¸­ | 1. æµ‹è¯•ä¸»æµæµè§ˆå™¨<br>2. æä¾›é™çº§æ–¹æ¡ˆï¼ˆçº¯æ–‡æœ¬åˆ†äº«ï¼‰ |
| **æœ¬åœ°å­˜å‚¨ç©ºé—´é™åˆ¶** | ä½ | 1. é™åˆ¶å†å²æ•°é‡ï¼ˆæœ€å¤š50æ¡ï¼‰<br>2. å‹ç¼©å­˜å‚¨ |
| **å¤š AI æˆæœ¬è¶…é¢„ç®—** | ä½ | 1. ä¼˜å…ˆä½¿ç”¨ä½æˆæœ¬æ¨¡å‹<br>2. ç¼“å­˜å¸¸è§é—®é¢˜ |
| **åŸ‹ç‚¹æ•°æ®éšç§åˆè§„** | ä¸­ | 1. æ•°æ®åŒ¿ååŒ–<br>2. æ˜ç¡®éšç§æ”¿ç­– |

---

## 7. éšç§ä¸åˆè§„

### 7.1 æ•°æ®å¤„ç†åŸåˆ™

| æ•°æ®ç±»å‹ | å¤„ç†æ–¹å¼ | åˆè§„ä¾æ® |
|---------|---------|---------|
| **å¯¹è¯å†…å®¹** | ä»…ä¿å­˜åœ¨ç”¨æˆ·è®¾å¤‡æœ¬åœ° | GDPR / CCPA |
| **åŸ‹ç‚¹æ•°æ®** | åŒ¿ååŒ–ï¼Œ30å¤©ååˆ é™¤ | æ•°æ®æœ€å°åŒ– |
| **IP åœ°å€** | åŒ¿ååŒ–å¤„ç† | éšç§ä¿æŠ¤ |

### 7.2 ç”¨æˆ·å‘ŠçŸ¥

```
éšç§æç¤ºï¼ˆé¦–æ¬¡å¼€å¯å†å²è®°å½•æ—¶æ˜¾ç¤ºï¼‰ï¼š
"ä½ çš„å¯¹è¯å†å²å°†ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ï¼Œä»…ä½ å¯è§ã€‚
æˆ‘ä»¬ä¸ä¼šä¸Šä¼ æˆ–åˆ†äº«ä½ çš„å¯¹è¯å†…å®¹ã€‚
éšæ—¶å¯ä»¥æ¸…ç©ºå†å²è®°å½•ã€‚"
```

---

## 8. ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´è¯´æ˜ |
|------|------|---------|
| v2.3 | 2026-02-05 | å…¨é‡ä¼˜åŒ–ç‰ˆï¼šé‡‘å¥æµ·æŠ¥ã€Toastæç¤ºã€ç§»åŠ¨ç«¯å…¨å±ã€åŸ‹ç‚¹ç³»ç»Ÿã€å¤šAIæ”¯æŒã€å¯¹è¯å†å² |
| v2.2 | 2026-01-31 | å¢å¼ºè½åœ°ç‰ˆï¼šåˆ†äº«åŠŸèƒ½ã€å®‰å…¨è¿‡æ»¤ã€ç§»åŠ¨ç«¯è§„èŒƒ |
| v2.1 | 2026-01-29 | åˆç‰ˆ PRD |

---

## 9. å®æ–½è®°å½•

| å®æ–½é˜¶æ®µ | æ—¥æœŸ | å®Œæˆå†…å®¹ | ç‰ˆæœ¬ |
|---------|------|---------|------|
| **å¾…å¼€å§‹** | - | v2.3 å…¨é‡ä¼˜åŒ–å¼€å‘ | - |

---

## é™„å½•

### A. æŠ€æœ¯å‚è€ƒæ–‡æ¡£

- [html2canvas æ–‡æ¡£](https://html2canvas.hertzen.com/)
- [Vercel AI SDK æ–‡æ¡£](https://sdk.vercel.ai/docs)
- [Next.js App Router](https://nextjs.org/docs/app)

### B. è”ç³»äºº

| è§’è‰² | å§“å | èŒè´£ |
|------|------|------|
| äº§å“ç»ç† | [å¾…å¡«å†™] | éœ€æ±‚å†³ç­–ã€éªŒæ”¶ |
| å¼€å‘è´Ÿè´£äºº | [å¾…å¡«å†™] | æŠ€æœ¯å®ç° |
| UI è®¾è®¡å¸ˆ | [å¾…å¡«å†™] | è§†è§‰è®¾è®¡ |
